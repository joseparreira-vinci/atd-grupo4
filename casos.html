<!doctype html>
<html lang="pt">
<head>  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Casos Fechados — Dashboard Inspetivo</title>
  <link href="https://fonts.googleapis.com/css2?family/Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>
<body>
  <div class="frame">
    <div class="topbar">
      <div class="brand">
        <div class="hamburger" id="hamburger" aria-label="Abrir menu" title="Menu">
          <div class="bars"></div>
        </div>
        <img src="logo-at.png" alt="Logo ATD" class="logo">
        <div>
          <div style="font-weight:700">Painel Inspetivo — Antónia</div>
          <div style="font-size:12px;color:var(--muted)">Casos Fechados</div>
        </div>
      </div>
      <select id="fiscal-year" style="padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.1);background:var(--bg);color:var(--muted);">
        <option value="2023">Ano Fiscal 2023</option>
        <option value="2024">Ano Fiscal 2024</option>
        <option value="2025" selected>Ano Fiscal 2025</option>
      </select>
    </div>

    <aside class="sidebar" id="sidebar">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <div class="menu-title">Menu</div>
        <button class="btn ghost close-btn" onclick="closeSidebar()" style="font-size:18px;">×</button>
      </div>
      <div class="menu-list">
        <a class="menu-item" href="index.html">Dashboard</a>
        <a class="menu-item" href="contribuintes.html">Contribuintes</a>
        <a class="menu-item" href="casos.html">Casos Fechados</a>
        <a class="menu-item" href="relatorios.html">Relatórios</a>
        <a class="menu-item" href="equipa.html">Equipa</a>
        <a class="menu-item" href="gestor.html">Gestor</a>
        <a class="menu-item" href="elearning.html">Elearning</a>
        <a class="menu-item" href="notificacoes.html">Notificações</a>
      </div>
    </aside>

    <main class="main">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2>Casos Fechados</h2>
      </div>
      <div class="card">
        <table style="width:100%;border-collapse:collapse;">
          <thead>
            <tr>
              <th style="text-align:left;padding:8px;border-bottom:1px solid rgba(255,255,255,0.1);color:var(--muted);font-weight:600">ID</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid rgba(255,255,255,0.1);color:var(--muted);font-weight:600">Nome do Caso</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid rgba(255,255,255,0.1);color:var(--muted);font-weight:600">Estado</th>
              <th style="text-align:left;padding:8px;border-bottom:1px solid rgba(255,255,255,0.1);color:var(--muted);font-weight:600">Ações</th>
            </tr>
          </thead>
          <tbody id="table-body">
          </tbody>
        </table>
      </div>
    </main>
  </div>

  <script>
    // Sidebar hamburger
    const sidebar = document.getElementById('sidebar');
    document.getElementById('hamburger').addEventListener('click',()=>{
      sidebar.classList.toggle('open');
    });

    function closeSidebar() {
      sidebar.classList.remove('open');
    }

    // Close sidebar on link click
    document.querySelectorAll('.menu-item').forEach(el=>{
      el.addEventListener('click',()=>{
        sidebar.classList.remove('open');
      });
    });

    // Exemplos de casos
    let casos = [
      { id: 1, nome: "Caso Empresa B - Fornecedores inativos", estado: "Fechado" },
      { id: 2, nome: "Caso NIF 987675435 - Património vs Rendimentos", estado: "Fechado" },
      { id: 3, nome: "Caso Empresa C - Diferença IVA/IRC", estado: "Fechado" },
      { id: 4, nome: "Caso Empresa D - Verificação de faturas", estado: "Fechado" }
    ];

    function atualizarCasos(){
      const tbody = document.getElementById('table-body');
      tbody.innerHTML = '';
      const casosFechados = casos.filter(c => c.estado === 'Fechado');
      casosFechados.forEach(c=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.05);">${c.id}</td><td style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.05);">${c.nome}</td><td style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.05);">${c.estado}</td><td style="padding:8px;border-bottom:1px solid rgba(255,255,255,0.05);"><button class="btn" onclick="verCaso(${c.id})">Ver Detalhes</button></td>`;
        tbody.appendChild(tr);
      });
    }

    function verCaso(id){
      const caso = casos.find(c => c.id === id);
      alert('Detalhes do caso: ' + caso.nome + ' - Estado: ' + caso.estado);
    }

    function concluirCaso(id){
      const caso = casos.find(x=>x.id===id);
      caso.estado = 'fechado';
      let relatorios = JSON.parse(localStorage.getItem('relatorios')) || [];
      relatorios.push({nome: caso.nome + ' — Relatório concluído.'});
      localStorage.setItem('relatorios', JSON.stringify(relatorios));
      atualizarCasos();
      window.location.href = 'relatorios.html';
    }

    // Init
    atualizarCasos();
  </script>
</body>

</html>
